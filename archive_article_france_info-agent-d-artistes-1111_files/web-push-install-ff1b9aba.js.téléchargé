"use strict";(self.webpackChunkfranceinfo_package=self.webpackChunkfranceinfo_package||[]).push([[4652,7993,8543],{515:function(i,t,n){function e(i){!function(i,t,n,e,a){var o,s="Promise"in i,r={then:function(){return r},catch:function(i){return i(new Error("Airship SDK Error: Unsupported browser")),r}},d=s?new Promise(function(i,t){o=function(n,e){n?t(n):i(e)}}):r;d._async_setup=function(i){if(s)try{o(null,i(a))}catch(i){o(i)}},i.UA=d;var c=t.createElement("script");c.src=n,c.async=!0,c.id="_uasdk",c.rel="UA",t.head.appendChild(c)}(window,document,i.sdkUrl,0,{vapidPublicKey:i.vapidPublicKey,websitePushId:i.websitePushId,appKey:i.appKey,token:i.token,workerUrl:"/service-worker.js",components:{inAppAutomation:{enabled:!1}}})}n.d(t,{p:function(){return e}})},5613:function(i,t,n){n.d(t,{f:function(){return e}});const e={NL_EVENT_GROUP:90,WEB_PUSH:95,NOTIFICATION_APP:100,MATCH_PANEL:150,EVENT_BANNER:200,ALERT_INFO:300,BOOKMARK_BUTTON:350}},9982:function(i,t,n){n.a(i,async function(i,t){try{var e=n(515),a=n(5613);function o(i,t,n){return(t=s(t))in i?Object.defineProperty(i,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[t]=n,i}function s(i){var t=r(i,"string");return"symbol"==typeof t?t:t+""}function r(i,t){if("object"!=typeof i||!i)return i;var n=i[Symbol.toPrimitive];if(void 0!==n){var e=n.call(i,t||"default");if("object"!=typeof e)return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(i)}const d=await n.e(8760).then(n.bind(n,1941));class c{constructor(i,t,n,e){var a;this.config=i,this.piano=t,this.utils=n,this.stickyOrchestrator=e,o(this,"loadSdkPromise",null),o(this,"initalNotificationPermission",null===(a=window.Notification)||void 0===a?void 0:a.permission),o(this,"dialogEl",document.querySelector(".web-push-install__popin")),o(this,"dialog",void 0),o(this,"POPIN_DISPLAY_COOKIE_NAME","ftvi-web-push-popin-display"),this.init()}async init(){const i=(await n.e(7051).then(n.bind(n,8324))).default;this.dialog=new i(this.dialogEl,this.utils,this.stickyOrchestrator),this.initPopin(),this.autoOptIn(),this.autoOptOut()}async autoOptIn(){var i;if("granted"===(null===(i=window.Notification)||void 0===i?void 0:i.permission)){var t;const i=await this.loadSdk();null!==(t=i.channel)&&void 0!==t&&t.optedIn||i.register()}}async autoOptOut(){var i;"denied"===(null===(i=window.Notification)||void 0===i?void 0:i.permission)&&await this.loadSdk()}loadSdk(){var i=this;return this.loadSdkPromise||(this.loadSdkPromise=new Promise(async function(t){const n=await i.config.getConfig();(0,e.p)(n.airship),window.UA.then(i=>{t(i)})})),this.loadSdkPromise}initPopin(){var i=this;d.displayBanner({priority:a.f.WEB_PUSH,displayPromise:this.canBeDisplayed(),callback:()=>{this.loadSdk().then(()=>{this.dialog.show()})}}),d.updateLoadingState(this.constructor.name),this.dialog.onPrimary(async function(){i.dialog.hide();const t=await i.loadSdk();i.sendTrackingEvent("print"),t.register().then(()=>{i.sendTrackingEvent("click","activer_les_notifications")},()=>{i.sendTrackingEvent("click","refuser_les_notifications")})}),this.dialog.onSecondary(()=>{this.onRefuse()}),this.dialog.onClose(()=>{this.onRefuse()})}onRefuse(){this.utils.createCookie(this.POPIN_DISPLAY_COOKIE_NAME,"true",15,"days"),this.dialog.hide()}async canBeDisplayed(){var i;const t="true"===this.utils.readCookie(this.POPIN_DISPLAY_COOKIE_NAME),n="default"===(null===(i=window.Notification)||void 0===i?void 0:i.permission),e=await this.isAndroidAppInstalled();return Promise.resolve(!t&&n&&!e)}async isAndroidAppInstalled(){const i=await this.config.getConfig();return"getInstalledRelatedApps"in navigator&&!!(await navigator.getInstalledRelatedApps()).find(t=>t.id===i.playstoreAppId)}sendTrackingEvent(i="click",t=""){"default"===this.initalNotificationPermission&&this.piano.sendEvent(i,{feature:"pop_in_activation_des_notifications",click:t})}}new Promise(async i=>{d.addBannersLoading(c.name);const t=await(await n.e(3355).then(n.bind(n,6672))).default,e=await(await n.e(9292).then(n.bind(n,3703))).default,a=await n.e(9980).then(n.bind(n,5321)),o=await(await n.e(3708).then(n.bind(n,3157))).default;i(new c(t,e,a,o))}),t()}catch(l){t(l)}},1)}},function(i){i(i.s=9982)}]);