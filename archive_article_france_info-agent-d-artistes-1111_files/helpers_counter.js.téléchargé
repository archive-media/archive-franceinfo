(()=>{var e={88:e=>{e.exports={apiUrl:"https://graphcomment.com",wsUrl:"wss://graphcomment.com/websocket",imageUrl:"https://graphcomment.com",graphUrl:"https://graphcomment.com/api/graphql",yakliUrl:"https://yak.li/",WITH_TIMER:!1,VERBOSE:!1,IS_DEV:!1}}},r={};function t(o){var n=r[o];if(void 0!==n)return n.exports;var a=r[o]={exports:{}};return e[o](a,a.exports,t),a.exports}t.d=(e,r)=>{for(var o in r)t.o(r,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:r[o]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r);var o={};(()=>{"use strict";t.d(o,{default:()=>f});const e=(()=>{try{return"undefined"!=typeof window&&!!window||"undefined"!=typeof process&&process.browser}catch(e){return console.error(e),!1}})(),r=t(88),{apiUrl:n,imageUrl:a,graphUrl:c,wsUrl:s,WITH_TIMER:i}=r;r.VERBOSE,Object.assign(Object.assign({},r),{devTools:r.IS_DEV||e&&window.location.search.includes("dev"),defaultLocale:"fr",disableCache:!0,enableSEOLdInFront:!1,rootElementSelector:"#__next",zIndexHeaderPopover:900,showMessageId:!1,checkVIPAfterProfileCreation:!0,enableExperimentalEditorjs:!0,bbfSelectionAlwaysOnLeft:!1,enableAbortQuery:!1,oneSignalSWScope:"/push/onesignal/",oneSignalAppIds:{"localhost:3000":"d113c273-1d23-4962-be5e-aa7e02391536","debate.graphcomment.com":"XXXX"},oneSignalVerbose:!0,oneSignalOnLocalhost:!1,logRocketId:r.IS_DEV?"4zegaz/graphdebate-dev":"4zegaz/graphdebate",fontOptionalInsteadOfSwap:!1});const l=e=>null!=e;function u({path:e,params:r}){return`${e}${function(e={}){const r=new URLSearchParams;return Object.entries(e).filter((([e,r])=>!!e&&l(r))).forEach((([e,t])=>{Array.isArray(t)?t.filter(l).forEach((t=>r.append(e,t.toString()))):r.append(e,t.toString())})),t=r.toString(),o="?",t?`${o}${t}`:"";var t,o}(r)}`}var p=function(e,r,t,o){return new(t||(t=Promise))((function(n,a){function c(e){try{i(o.next(e))}catch(e){a(e)}}function s(e){try{i(o.throw(e))}catch(e){a(e)}}function i(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(c,s)}i((o=o.apply(e,r||[])).next())}))};const d={"Content-Type":"application/json"};function h({params:e,cb:r,apiUrl:t,wsUrl:o}){!function({url:e,onSuccess:r=()=>null,onFailure:t=()=>null}){p(this,void 0,void 0,(function*(){try{const t=yield function(e){return p(this,void 0,void 0,(function*(){const r=yield fetch(e,{method:"GET",headers:d});if(r.ok)return r.text();throw new Error(`Failed GET request to ${e}`)}))}(e);r(t)}catch(e){t(e)}}))}({url:u({path:`${t}/api/pub/numberOfComments`,params:e}),onSuccess:n=>{let a;try{a=JSON.parse(n)}catch(r){return void console.error(`[graphcomment counter] fail to decode response "${n}", using url "${e.url}"`)}if("number"==typeof a.count)if(r(a.count),a.website.websocket&&a.website.websocket.notification){let{count:e}=a;!function({threadId:e,cb:r,wsUrl:t}){const o=new WebSocket(t);o.onerror=e=>console.error("WS error",e),o.onmessage=e=>{let t;try{t=JSON.parse(e.data)}catch(r){return void console.error("unable to parse WS event",e.data)}r(t)},o.onopen=()=>{o.send(JSON.stringify({joinThread:e}))}}({threadId:a.thread,cb:()=>{e+=1,r(e)},wsUrl:o})}else setTimeout((()=>{h({params:e,cb:r,apiUrl:t,wsUrl:o})}),3e4)},onFailure:()=>{console.error(`[graphcomment counter] invalid url "${e.url}", this url is not rattached to a GraphComment page.`)}})}const f=e=>function({graphcommentId:e,apiUrl:r,wsUrl:t}){Array.from(document.querySelectorAll(".gc-counter")).forEach((o=>{const n=o.dataset.url||"/",{uid:a,guid:c}=o.dataset;h({params:{url:n,uid:a,guid:c,website:e},cb(e){o.textContent=e.toString()},apiUrl:r,wsUrl:t})}))}({apiUrl:n,wsUrl:s,graphcommentId:e})})(),window.__semio__helpers_counter=o.default})();