"use strict";(self.webpackChunkfranceinfo_package=self.webpackChunkfranceinfo_package||[]).push([[296,4836],{7928:function(e,t,i){var n=i(9476);function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach(function(t){s(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function s(e,t,i){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class o{constructor(e,t,i){this.auth=e,this.utils=t,this.stickyOrchestrator=i,s(this,"HEADER_STICKY_HIDDEN_CLASS","header--sticky-hidden"),s(this,"HEADER_MAIN_OPENED_CLASS","header-main__menu--opened"),s(this,"HEADER_SUB_OPENED_CLASS","header-sub__menu--opened"),s(this,"BODY_MENU_OPENED_CLASS","menu--opened"),s(this,"SKIPLINKS_DISPLAYED_CLASS","skip-links--displayed"),s(this,"ANIMATED_ICON_PLAYED_CLASS","animated-icon--played"),s(this,"skipLinksComponent",void 0),s(this,"mainContentSkipLink",void 0),s(this,"mainContentBlock",void 0),s(this,"header",void 0),s(this,"navigationPanel",void 0),s(this,"mainBurgerMenu",void 0),s(this,"mainBurgerMenuIcon",void 0),s(this,"subBurgerMenu",void 0),s(this,"subBurgerMenuIcon",void 0),s(this,"headerAccount",void 0),s(this,"lastScroll",window.scrollY),s(this,"stickyConfig",void 0),this.utils.onReadyStateChange("complete",()=>this.init())}init(){this.header=document.querySelector(".header"),this.navigationPanel=document.querySelector(".navigation-panel"),this.header&&this.navigationPanel&&(this.mainBurgerMenu=this.header.querySelector(".header-main__menu"),this.mainBurgerMenuIcon=this.mainBurgerMenu.querySelector(".header-main__menu-icon"),this.subBurgerMenu=this.header.querySelector(".header-sub__menu-entry .navigation-item__link"),this.subBurgerMenuIcon=this.subBurgerMenu.querySelector(".navigation-item__icon"),this.headerAccount=this.header.querySelector(".header-main__account-entry"),queueMicrotask(()=>{this.a11ySetupSkipLinks()}),queueMicrotask(()=>{this.a11ySetupH1()}),queueMicrotask(()=>{this.a11yAriaCurrent()}),queueMicrotask(()=>{this.bindEvents()}),queueMicrotask(()=>{this.initActiveItems()}),queueMicrotask(()=>{this.initSSO()}))}a11ySetupSkipLinks(){if(this.skipLinksComponent=this.header.querySelector(".skip-links"),this.mainContentSkipLink=this.header.querySelector(".skip-links__main-content"),this.mainContentBlock=document.querySelector("#base-page__main-content"),this.utils.isMobileDevice())this.skipLinksComponent.setAttribute("hidden","hidden");else{var e;this.mainContentSkipLink.addEventListener("focus",()=>{this.skipLinksComponent.classList.add(this.SKIPLINKS_DISPLAYED_CLASS),this.initPageAreas()});for(const e of["blur","click"])this.mainContentSkipLink.addEventListener(e,()=>{var t;this.skipLinksComponent.classList.remove(this.SKIPLINKS_DISPLAYED_CLASS),this.resetPageAreas(),"click"===e&&(null===(t=this.mainContentBlock)||void 0===t||t.focus({preventScroll:!0}))});null===(e=this.mainContentBlock)||void 0===e||e.addEventListener("focus",()=>{var e;null===(e=this.mainContentBlock)||void 0===e||e.removeAttribute("tabindex")})}}a11ySetupH1(){if(document.querySelector("#base-page__main-content h1"))return;const e=document.createElement("h1");e.classList.add("header-main__title");const t=this.header.querySelector(".header-main__logo-link");t.parentNode.insertBefore(e,t),e.appendChild(t)}a11yAriaCurrent(){"/"===document.location.pathname&&this.header.querySelector(".header-main__logo-link").setAttribute("aria-current","page")}bindEvents(){for(const e of[this.mainBurgerMenu,this.subBurgerMenu])e.addEventListener("click",()=>this.navigationPanel.dispatchEvent(new CustomEvent("NavigationPanel::toggle")));this.navigationPanel.addEventListener("NavigationPanel::opened",()=>{document.body.classList.add(this.BODY_MENU_OPENED_CLASS),this.mainBurgerMenuIcon.classList.add(this.ANIMATED_ICON_PLAYED_CLASS),this.subBurgerMenuIcon.classList.add(this.ANIMATED_ICON_PLAYED_CLASS),this.mainBurgerMenu.setAttribute("title","Fermer le menu franceinfo")}),this.navigationPanel.addEventListener("NavigationPanel::closed",()=>{document.body.classList.remove(this.BODY_MENU_OPENED_CLASS),this.mainBurgerMenuIcon.classList.remove(this.ANIMATED_ICON_PLAYED_CLASS),this.subBurgerMenuIcon.classList.remove(this.ANIMATED_ICON_PLAYED_CLASS),this.mainBurgerMenu.setAttribute("title","Ouvrir le menu franceinfo"),setTimeout(()=>{(this.utils.isBreakpoint("large")?this.subBurgerMenu:this.mainBurgerMenu).focus()},10)}),this.stickyConfig={zone:"top",priority:n.M.HEADER,element:this.header,show:!0},this.stickyOrchestrator.updateFixedElement(this.stickyConfig),this.utils.onScroll(()=>{this.stuckDisplay()},{throttleMaxWait:300}),this.header.addEventListener("Header::display",()=>{this.header.classList.contains(this.HEADER_STICKY_HIDDEN_CLASS)&&(this.stickyOrchestrator.updateFixedElement(a(a({},this.stickyConfig),{},{show:!0})),this.header.classList.remove(this.HEADER_STICKY_HIDDEN_CLASS))})}stuckDisplay(){const e=window.scrollY,t=window.innerHeight/3,i=e>this.lastScroll,n=this.header.classList.contains(this.HEADER_STICKY_HIDDEN_CLASS),r=e-this.lastScroll>t;let s=!1;i&&r?(s=!n,this.lastScroll=e):i||(s=n,this.lastScroll=e),s&&(this.stickyOrchestrator.updateFixedElement(a(a({},this.stickyConfig),{},{show:n})),this.header.classList.toggle(this.HEADER_STICKY_HIDDEN_CLASS))}initActiveItems(){const e=window.location.pathname;let t=!1;for(const n of Array.from(this.header.querySelectorAll(".header-main__entries .navigation-item__link, .header-sub__entries .navigation-item__link"))){var i;t||n.getAttribute("href")!==e||(t=!0,null===(i=n.closest(".navigation-item"))||void 0===i||i.classList.add("navigation-item--active"),n.setAttribute("aria-current","page"))}for(const t of Array.from(this.navigationPanel.querySelectorAll(".navigation-panel__mainpanel .panel-item__content, .navigation-panel__subpanel .panel-item__content"))){var n,r,a,s,o;(null!==(n=null!==(r=t.getAttribute("href"))&&void 0!==r?r:t.getAttribute("data-href"))&&void 0!==n?n:"").startsWith("/")&&e===(null!==(a=null!==(s=t.getAttribute("href"))&&void 0!==s?s:t.getAttribute("data-href"))&&void 0!==a?a:"")&&(null===(o=t.closest(".panel-item"))||void 0===o||o.classList.add("panel-item--active"),t.setAttribute("aria-current","A"===t.tagName?"page":"true"))}for(const t of Array.from(this.navigationPanel.querySelectorAll(".navigation-panel__subpanel .navigation-panel__taxo-link"))){var u;e===(null!==(u=t.getAttribute("href"))&&void 0!==u?u:"")&&t.setAttribute("aria-current","page")}}async initSSO(){if(!this.auth.getCachedIsUserLogged())return void this.bindUnLoggedMenu();const e=await this.auth.getUserInfo();if(null!=e&&e.connected)return this.displayLoggedMenu(),void this.bindLoggedMenu();this.bindUnLoggedMenu()}displayLoggedMenu(){this.headerAccount.querySelector(".navigation-item__link .navigation-item__left-icon").firstElementChild.setAttribute("xlink:href","#ftvi-icon-person-outlined-connected"),this.headerAccount.classList.replace("user--not-logged","user--logged")}bindUnLoggedMenu(){const e=this.headerAccount.querySelector(".account--subscribe"),t=this.headerAccount.querySelector(".account--login");this.bindPanelItemCallback(e,()=>this.auth.subscribe()),this.bindPanelItemCallback(t,()=>this.auth.login())}bindLoggedMenu(){const e=this.headerAccount.querySelector(".account--informations"),t=this.headerAccount.querySelector(".account--logout");this.bindPanelItemCallback(e,()=>this.auth.myAccount()),this.bindPanelItemCallback(t,()=>this.auth.logout())}bindPanelItemCallback(e,t){e.querySelector("a").addEventListener("click",t),e.addEventListener("keydown",e=>{const i=e.code;"Enter"!==i&&"Space"!==i||t()})}initPageAreas(){var e;const t=this.header.querySelector(".header-main__nav"),i=this.header.querySelector(".header-sub__nav");null===(e=this.mainContentBlock)||void 0===e||e.setAttribute("tabindex","-1"),null==t||t.setAttribute("tabindex","-1"),null==i||i.setAttribute("tabindex","-1")}resetPageAreas(){var e;const t=this.header.querySelector(".header-main__nav"),i=this.header.querySelector(".header-sub__nav");null===(e=this.mainContentBlock)||void 0===e||e.setAttribute("tabindex","0"),null==t||t.removeAttribute("tabindex"),null==i||i.removeAttribute("tabindex")}}new Promise(e=>{(async()=>{const t=await(await i.e(4895).then(i.bind(i,4284))).default,n=await i.e(9980).then(i.bind(i,5321)),r=await(await i.e(3708).then(i.bind(i,3157))).default,a=new o(t,n,r);e(a)})()})},9476:function(e,t,i){i.d(t,{M:function(){return n}});const n={HEADER:0,EVENT_BAR:1,IN_PAGE_NAV:2,LIVE_TIMELINER_HEADER:3,BACK_TO_TOP:5,LIVE_PARTICIPATE_BTN:4,NOTIFICATION:3,DIALOG:2,EVENT_BANNER:1,ALERT_INFO:1,SNACKBAR:0}}},function(e){e(e.s=7928)}]);